{"ast":null,"code":"import _objectSpread from\"/Users/cris/Code/pokemon-league/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/cris/Code/pokemon-league/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/cris/Code/pokemon-league/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/cris/Code/pokemon-league/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import{Switch,Route}from'react-router-dom';import{makeStyles}from'@material-ui/styles';import Header from'./components/UI/Header/Header';import Hero from'./components/Hero/Hero';import Profile from'./containers/Profile/Profile';import PageNotFound from'./components/UI/PageNotFound/PageNotFound';import axios from'axios';import AuthUserContext from'./context/AuthUserContext';import SnackbarContext from'./context/SnackbarContext';import Loader from'./components/UI/Loader/Loader';import Trainers from'./components/Trainers/Trainers';import{ApiManager}from'./helpers/ApiManager';import SnackbarMessage from'./components/UI/SnackbarMessage/SnackbarMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var useStyles=makeStyles({App:{textAlign:'center',height:'100%'},loader:{position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)'}});var App=function App(){// variables\nvar classes=useStyles();// state\nvar _useState=useState(null),_useState2=_slicedToArray(_useState,2),authUser=_useState2[0],setAuthUser=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),snackbar=_useState4[0],setSnackbar=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),isLoading=_useState6[0],setIsLoading=_useState6[1];// useEffect\nuseEffect(function(){var getCsrfToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$ApiManager$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ApiManager.getCSRFToken();case 2:_yield$ApiManager$get=_context.sent;data=_yield$ApiManager$get.data;axios.defaults.headers.post['X-CSRF-Token']=data.csrfToken;axios.defaults.headers.patch['X-CSRF-Token']=data.csrfToken;case 6:case\"end\":return _context.stop();}}},_callee);}));return function getCsrfToken(){return _ref.apply(this,arguments);};}();var isLoggedIn=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,_response,_err$response,data,error;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return ApiManager.checkIsLoggedIn();case 3:response=_context2.sent;setAuthUser(response.data.user);setIsLoading(false);_context2.next=17;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](0);_response=_context2.t0.response,_err$response=_context2.t0.response,data=_err$response.data,error=_err$response.data.error;console.error(error);if(!(error&&error.errors&&error.errors.TokenExpiredError)){_context2.next=15;break;}alert(\"Token expired. Please login again\");return _context2.abrupt(\"return\");case 15:if(_response.status===500){setSnackbar({severity:'error',message:\"Internal server error\"});}setIsLoading(false);case 17:case\"end\":return _context2.stop();}}},_callee2,null,[[0,8]]);}));return function isLoggedIn(){return _ref2.apply(this,arguments);};}();getCsrfToken();isLoggedIn();},[]);return/*#__PURE__*/_jsx(\"div\",{className:classes.App,children:isLoading?/*#__PURE__*/_jsx(Loader,{}):/*#__PURE__*/_jsxs(SnackbarContext.Provider,{value:{snackbar:snackbar,setSnackbar:setSnackbar},children:[/*#__PURE__*/_jsxs(AuthUserContext.Provider,{value:{authUser:authUser,setAuthUser:setAuthUser},children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/profile/:id\",render:function render(props){return/*#__PURE__*/_jsx(Profile,_objectSpread({authUser:authUser},props));}}),/*#__PURE__*/_jsx(Route,{path:\"/trainers\",render:function render(props){return/*#__PURE__*/_jsx(Trainers,_objectSpread({authUser:authUser},props));}}),/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,component:Hero}),/*#__PURE__*/_jsx(Route,{path:\"*\",component:PageNotFound})]})]}),snackbar&&/*#__PURE__*/_jsx(SnackbarMessage,{snackbar:snackbar,onClose:function onClose(){return setSnackbar(null);}})]})});};export default App;","map":{"version":3,"sources":["/Users/cris/Code/pokemon-league/src/App.tsx"],"names":["useEffect","useState","Switch","Route","makeStyles","Header","Hero","Profile","PageNotFound","axios","AuthUserContext","SnackbarContext","Loader","Trainers","ApiManager","SnackbarMessage","useStyles","App","textAlign","height","loader","position","top","left","transform","classes","authUser","setAuthUser","snackbar","setSnackbar","isLoading","setIsLoading","getCsrfToken","getCSRFToken","data","defaults","headers","post","csrfToken","patch","isLoggedIn","checkIsLoggedIn","response","user","error","console","errors","TokenExpiredError","alert","status","severity","message","props"],"mappings":"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","sourcesContent":["import { useEffect, useState } from 'react';\nimport { Switch, Route } from 'react-router-dom';\nimport { makeStyles } from '@material-ui/styles';\n\nimport Header from './components/UI/Header/Header';\nimport Hero from './components/Hero/Hero';\nimport Profile from './containers/Profile/Profile';\nimport PageNotFound from './components/UI/PageNotFound/PageNotFound';\nimport axios from 'axios';\nimport AuthUserContext from './context/AuthUserContext';\nimport SnackbarContext from './context/SnackbarContext';\nimport Loader from './components/UI/Loader/Loader';\nimport Trainers from './components/Trainers/Trainers';\nimport { AUTHUSER } from './types';\nimport { ApiManager } from './helpers/ApiManager';\nimport SnackbarMessage from './components/UI/SnackbarMessage/SnackbarMessage';\n\nconst useStyles = makeStyles({\n  App: {\n    textAlign: 'center',\n    height: '100%'\n  },\n  loader: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translate(-50%, -50%)'\n  }\n});\n\nconst App = () => {\n  // variables\n  const classes = useStyles();\n\n  // state\n  const [authUser, setAuthUser] = useState<AUTHUSER>(null);\n  const [snackbar, setSnackbar] = useState<any>(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  // useEffect\n  useEffect(() => {\n    const getCsrfToken = async () => {\n      const { data } = await ApiManager.getCSRFToken();\n      axios.defaults.headers.post['X-CSRF-Token'] = data.csrfToken;\n      axios.defaults.headers.patch['X-CSRF-Token'] = data.csrfToken;\n    };\n    \n\n    const isLoggedIn = async () => {\n      try {\n        const response = await ApiManager.checkIsLoggedIn();\n        setAuthUser(response.data.user);\n        setIsLoading(false);\n      } catch (err: any) {\n          const { response, response: { data, data: { error }} }: any = err;\n          console.error(error);\n          if (error && error.errors && error.errors.TokenExpiredError) {\n            alert(\"Token expired. Please login again\");\n            return;\n          }\n          if (response.status === 500) {\n            setSnackbar({\n              severity: 'error',\n              message: \"Internal server error\"\n            });\n          }\n          setIsLoading(false);  \n      }\n    }\n    \n    getCsrfToken();\n    isLoggedIn();\n  }, []);\n\n  return (\n    <div className={classes.App}>\n      { isLoading ? (\n        <Loader />\n      ) : (\n        <SnackbarContext.Provider value={{ snackbar, setSnackbar }}>\n          <AuthUserContext.Provider value={{ authUser, setAuthUser }}>\n            <Header />\n            <Switch>\n              <Route path=\"/profile/:id\" render={(props) => <Profile authUser={authUser} {...props} />}/>\n              <Route path=\"/trainers\" render={(props) => <Trainers authUser={authUser} {...props} />}/>\n              <Route path=\"/\" exact component={Hero}/>  \n              <Route path=\"*\" component={PageNotFound}/>\n            </Switch>\n          </AuthUserContext.Provider>\n          {snackbar && (\n            <SnackbarMessage \n              snackbar={snackbar} \n              onClose={() => setSnackbar(null)} \n            />\n          )}\n        </SnackbarContext.Provider>\n      )}\n    </div>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}